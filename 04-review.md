Review this code as a senior engineer.

Focus on:

- readability
- correctness
- maintainability
- unnecessary complexity

Point out concrete issues and suggest improvements.
Avoid stylistic nitpicks.
